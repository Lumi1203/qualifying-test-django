{% extends 'taketest/base.html' %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container mt-5" style="max-width: 600px;">

    <h2 class="text-center mb-4">Your Profile</h2>

    <div class="text-center mb-4">
        <img id="profilePreview"
             src="{{ profile.photo.url }}"
             class="rounded-circle"
             style="width: 150px; height: 150px; object-fit: cover;">
    </div>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <h5>User Information</h5>
        {{ user_form|crispy }}

        <h5 class="mt-3">Profile Photo</h5>
        {{ profile_form|crispy }}

        <button class="btn btn-success w-100 mt-3" type="submit">
            Save Changes
        </button>
    </form>

    <script>
    const fileInput = document.getElementById("id_photo");
    const preview = document.getElementById("profilePreview");

    fileInput.addEventListener("change", function(event) {
        const file = event.target.files[0];
        if (file) {
            preview.src = URL.createObjectURL(file);
        }
    });
    </script>

</div>
{% endblock %}
